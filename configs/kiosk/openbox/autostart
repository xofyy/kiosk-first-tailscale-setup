#!/bin/bash
# ACO Maintenance Panel - Openbox Autostart

# Disable screensaver
xset s off
xset -dpms
xset s noblank

# Apply screen rotation (independent of NVIDIA/MOK status)
# display-init.sh has its own wait and retry logic
/opt/aco-panel/scripts/display-init.sh &

# Check if setup is complete
# NOTE: This file is created by panel based on setup_complete value in MongoDB
if [ -f /etc/aco-panel/.setup-complete ]; then
    # Start in kiosk mode (installation complete)
    echo "kiosk" > /tmp/kiosk-current-mode
    /opt/aco-panel/scripts/chromium-kiosk.sh &
else
    # Start in panel mode (installation in progress)
    echo "panel" > /tmp/kiosk-current-mode
    /opt/aco-panel/scripts/chromium-panel.sh &
fi
